/**
 * microlightbox.js
 *
 * Copyright (C) 2018 Konstantin A Chugunnyj (KyberPrizrak)
 *
 * LICENSE:
 *
 * This file is part of microlightbox.
 *
 * microlightbox is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * microlightbox is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with microlightbox. If not, see <http://www.gnu.org/licenses/>.
 *
 * @author KyberPrizrak (www.kyberprizrak.ru)
 * @version 1.0.0 - 2018.06.16 19:49:00 GMT+3
 */
(function(){var e,m,n,p,G,P,Q,H,I,y,u;function R(a,b,d){try{e="auto";m="";n="auto";p=10;G=20;Q=P=100;I=H=0;y="rgba(0,0,0,0.7)";z=u=0;"object"===typeof b&&(b.type&&(e=b.type),b.title&&(m=b.title),b.titlePosition&&(n=b.titlePosition),0<=b.padding&&(p=b.padding),0<=b.margin&&(G=b.margin),0<=b.minWidth&&(P=b.minWidth),0<=b.minHeight&&(Q=b.minHeight),0<=b.maxWidth&&(H=b.maxWidth),0<=b.maxHeight&&(I=b.maxHeight),"string"===typeof b.overlayColor&&(y=b.overlayColor));v();J=document.body.style.overflow;c=
document.createElement("div");c.id="microlightbox_overlay";c.onclick=W;try{c.style.backgroundColor=y}catch(X){}document.body.style.overflow="hidden";document.body.appendChild(c);c.style.display="block";if("string"===typeof a&&"#"==a.charAt(0)&&(a=document.getElementById(a.substr(1)),!a))return;"auto"==e&&("object"===typeof a?e="IMG"==a.tagName?"image":"inline":"string"===typeof a&&(e=d?"image":"html"));"auto"==n&&(n="image"==e?"inside":"titlebar");"inline"==e&&("object"===typeof a?(k=a,h=document.createElement("div"),
h.id="microlightbox_spoof",h.style.display="none",k.parentNode.insertBefore(h,k),K(a)):e="html");"html"==e&&K(a);"image"==e&&(q=new Image,q.onload=function(){u=q.width;z=q.height;q.id="microlightbox_image";K(q)},q.src="object"===typeof a?a.getAttribute("src"):a)}catch(X){alert("microlightbox error #2")}}function K(a){t=document.createElement("div");t.id="microlightbox_content";t.style.padding=p+"px";"object"===typeof a?(t.appendChild(a),L=a.style.display,a.style.display=""):t.innerHTML=a;g=document.createElement("div");
g.id="microlightbox_body";g.appendChild(t);"image"==e&&(g.style.overflow="hidden");d=document.createElement("div");d.id="microlightbox_window";f=document.createElement("div");f.id="microlightbox_close";f.innerHTML="&times;";f.onclick=v;m?(r=document.createElement("div"),r.id="microlightbox_title",r.innerHTML=m,"titlebar"==n?(l=document.createElement("div"),l.id="microlightbox_titlebar",l.appendChild(f),l.appendChild(r),d.appendChild(l)):(r.style.marginBottom=p+"px",g.appendChild(r),c.appendChild(f))):
c.appendChild(f);d.appendChild(g);c.appendChild(d);c.style.backgroundImage="none";C()}function C(){try{if(d){var a=l?l.offsetHeight:0,b=0<D&&r&&!l?r.offsetHeight+p:0,c=document.documentElement.clientWidth,h=document.documentElement.clientHeight,k=d.offsetWidth-d.clientWidth,n=d.offsetHeight-d.clientHeight,m=P,M=Q,y=Math.max(m,0<H?H:c-2*G),v=Math.max(M,0<I?I:h-2*G),A=Math.max(1,m-k),w=Math.max(1,M-n-a-b),x=Math.max(A,y-k),E=Math.max(w,v-n-a-b),N=m,O=M;if("image"==e)A=x-2*p,E-=2*p,x=w=0,u>A||z>E?A/
u>E/z?(x=E,w=Math.ceil(E/z*u)):(w=A,x=Math.ceil(A/u*z)):(w=u,x=z),q.width=w,q.height=x,N=w+2*p,O=x+2*p;else{var J=t.scrollHeight,K=g.offsetWidth-g.clientWidth,L=g.offsetHeight-g.clientHeight;N=Math.max(A,t.scrollWidth);O=Math.max(w,J);0==D?v=Math.max(100,M):(N>x&&(O+=L),O>E&&(N+=K))}var B=Math.max(m,Math.min(y,N+k)),F=Math.max(M,Math.min(v,O+n+a+b)),U=Math.round(c/2-B/2),S=Math.round(h/2-F/2);d.style.margin="0px";d.style.left=U+"px";d.style.top=S+"px";d.style.width=B+"px";d.style.height=F+"px";g.style.height=
F-a+"px";if(f&&!l){var R=Math.round(f.offsetWidth/2),V=Math.round(f.offsetHeight/2);S<V||"image"!=e&&0<g.offsetWidth-g.clientWidth?(f.style.left=U+B+"px",f.style.top=Math.max(S-2*V,0)+"px"):(f.style.left=U+B-R+"px",f.style.top=S-V+"px")}("image"!=e||r&&!l)&&B>=D&&F>=T&&(B!=D||F!=T)&&setTimeout(C,10);D=B;T=F}}catch(Y){alert("microlightbox error #3")}}function W(a){if((a?a.target:window.event.srcElement)==c)return v(),!1}function v(){try{c&&(c.parentNode.removeChild(c),document.body.style.overflow=
J),h&&(k&&(k.style.display=L,h.parentNode.insertBefore(k,h)),h.parentNode.removeChild(h)),T=D=0,J="",L="none",f=r=l=t=g=d=c=q=k=h=null}catch(a){alert("microlightbox error #5")}return!1}var z=u=y=I=H=Q=P=G=p=n=m=e=void 0;var D=0,T=0,J="",L="none",h=null,k=null,q=null,c=null,d=null,g=null,t=null,l=null,r=null,f=null;window.addEventListener?(window.addEventListener("orientationchange",C),window.addEventListener("resize",C)):(window.attachEvent("onorientationchange",C),window.attachEvent("onresize",C));
window.microlightbox=function(a,b){"string"===typeof a&&"#"==a.charAt(0)&&(a=document.getElementById(a.substr(1)));"object"===typeof a&&"A"==a.tagName?a.onclick=function(){R(a.getAttribute("href"),b,!0);return!1}:R(a,b,!1)};window.microlightbox_close=v})();
