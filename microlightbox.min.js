/**
 * microlightbox.js
 *
 * Copyright (C) 2018 Konstantin A Chugunnyj (KyberPrizrak)
 *
 * LICENSE:
 *
 * This file is part of microlightbox.
 *
 * microlightbox is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * microlightbox is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with microlightbox. If not, see <http://www.gnu.org/licenses/>.
 *
 * @author KyberPrizrak (www.kyberprizrak.ru)
 * @version 1.0.3 - 2018.09.30 21:10:00 GMT+3
 */

(function(){var d,m,n,p,C,Q,R,I,J,K,z,v;function S(a,b){try{if(a){if("string"===typeof a&&"#"==a.charAt(0))a=document.getElementById(a.substr(1));else if("string"===typeof a&&"."==a.charAt(0)){try{var c=document.getElementsByClassName(a.substr(1))}catch(Z){c=document.querySelectorAll(a)}for(var d=0;d<c.length;d++)S(c[d],b);return}"object"===typeof a&&("object"!==typeof b&&(b={}),"string"!==typeof b.title&&(b.title=a.getAttribute("title")));"object"===typeof a&&"A"==a.tagName?a.onclick=function(){Y(a.getAttribute("href"),
b,!0);return!1}:Y(a,b,!1)}}catch(Z){}}function Y(a,b,c){try{d="auto";m="";n="auto";p=10;C=20;R=Q=100;K=J=I=0;z="rgba(0,0,0,0.7)";A=v=0;"object"===typeof b&&(b.type&&(d=b.type),b.title&&(m=b.title),b.titlePosition&&(n=b.titlePosition),0<=b.padding&&(p=b.padding),0<=b.margin&&(C=b.margin),0<=b.minWidth&&(Q=b.minWidth),0<=b.minHeight&&(R=b.minHeight),0<=b.maxWidth&&(I=b.maxWidth),0<=b.maxHeight&&(J=b.maxHeight),0<=b.width&&(K=b.width),"string"===typeof b.overlayColor&&(z=b.overlayColor));w();L=document.body.style.overflow;
e=document.createElement("div");e.id="microlightbox_overlay";e.onclick=ba;try{e.style.backgroundColor=z}catch(aa){}document.body.style.overflow="hidden";document.body.appendChild(e);e.style.display="block";if("string"===typeof a&&"#"==a.charAt(0)&&(a=document.getElementById(a.substr(1)),!a))return;"auto"==d&&("object"===typeof a?d="IMG"==a.tagName?"image":"inline":"string"===typeof a&&(d=c?"image":"html"));"auto"==n&&(n="image"==d?"inside":"titlebar");"inline"==d&&("object"===typeof a?(k=a,h=document.createElement("div"),
h.id="microlightbox_spoof",h.style.display="none",k.parentNode.insertBefore(h,k),M(a)):d="html");"html"==d&&M(a);"image"==d&&(q=new Image,q.onload=function(){v=q.width;A=q.height;q.id="microlightbox_image";M(q)},q.src="object"===typeof a?a.getAttribute("src"):a)}catch(aa){alert("microlightbox error #2")}}function M(a){t=document.createElement("div");t.id="microlightbox_content";t.style.padding=p+"px";"object"===typeof a?(t.appendChild(a),N=a.style.display,a.style.display=""):t.innerHTML=a;g=document.createElement("div");
g.id="microlightbox_body";g.appendChild(t);"image"==d&&(g.style.overflow="hidden");c=document.createElement("div");c.id="microlightbox_window";f=document.createElement("div");f.id="microlightbox_close";f.innerHTML="&times;";f.onclick=w;m?(r=document.createElement("div"),r.id="microlightbox_title",r.innerHTML=m,"titlebar"==n?(l=document.createElement("div"),l.id="microlightbox_titlebar",l.appendChild(f),l.appendChild(r),c.appendChild(l)):(r.style.marginBottom=p+"px",g.appendChild(r),e.appendChild(f))):
e.appendChild(f);c.appendChild(g);e.appendChild(c);e.style.backgroundImage="none";D()}function D(){try{if(c){var a=l?l.offsetHeight:0,b=0<E&&r&&!l?r.offsetHeight+p:0,e=document.documentElement.clientWidth,h=document.documentElement.clientHeight,k=c.offsetWidth-c.clientWidth,n=c.offsetHeight-c.clientHeight,m=Q,O=R,z=Math.max(m,0<I?I:e-2*C),w=Math.max(O,0<J?J:h-2*C),x=Math.max(1,m-k),y=Math.max(1,O-n-a-b),u=Math.max(x,z-k),F=Math.max(y,w-n-a-b),G=m,P=O;if("image"==d)x=u-2*p,F-=2*p,u=y=0,v>x||A>F?x/
v>F/A?(u=F,y=Math.ceil(F/A*v)):(y=x,u=Math.ceil(x/v*A)):(y=v,u=A),q.width=y,q.height=u,G=y+2*p,P=u+2*p;else{var L=t.scrollHeight,M=g.offsetWidth-g.clientWidth,N=g.offsetHeight-g.clientHeight;G=Math.max(x,t.scrollWidth);P=Math.max(y,L);if(0<K){var V=Math.min(K,e-2*C-k);V>=x&&V<=u&&(G=V)}0==E?w=Math.max(100,O):(G>u&&(P+=N),P>F&&(G+=M))}var B=Math.max(m,Math.min(z,G+k)),H=Math.max(O,Math.min(w,P+n+a+b)),W=Math.round(e/2-B/2),T=Math.round(h/2-H/2);c.style.margin="0px";c.style.left=W+"px";c.style.top=
T+"px";c.style.width=B+"px";c.style.height=H+"px";g.style.height=H-a+"px";if(f&&!l){var S=Math.round(f.offsetWidth/2),X=Math.round(f.offsetHeight/2);T<X||"image"!=d&&0<g.offsetWidth-g.clientWidth?(f.style.left=W+B+"px",f.style.top=Math.max(T-2*X,0)+"px"):(f.style.left=W+B-S+"px",f.style.top=T-X+"px")}("image"!=d||r&&!l)&&B>=E&&H>=U&&(B!=E||H!=U)&&setTimeout(D,10);E=B;U=H}}catch(ca){alert("microlightbox error #3")}}function ba(a){if((a?a.target:window.event.srcElement)==e)return w(),!1}function w(){try{e&&
(e.parentNode.removeChild(e),document.body.style.overflow=L),h&&(k&&(k.style.display=N,h.parentNode.insertBefore(k,h)),h.parentNode.removeChild(h)),U=E=0,L="",N="none",f=r=l=t=g=c=e=q=k=h=null}catch(a){alert("microlightbox error #5")}return!1}var A=v=z=K=J=I=R=Q=C=p=n=m=d=void 0;var E=0,U=0,L="",N="none",h=null,k=null,q=null,e=null,c=null,g=null,t=null,l=null,r=null,f=null;window.addEventListener?(window.addEventListener("orientationchange",D),window.addEventListener("resize",D)):(window.attachEvent("onorientationchange",
D),window.attachEvent("onresize",D));window.microlightbox=S;window.microlightbox_close=w})();
