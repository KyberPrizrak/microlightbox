/**
 * microlightbox.js
 *
 * Copyright (C) 2018 Konstantin A Chugunnyj (KyberPrizrak)
 *
 * LICENSE:
 *
 * This file is part of microlightbox.
 *
 * microlightbox is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * microlightbox is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with microlightbox. If not, see <http://www.gnu.org/licenses/>.
 *
 * @author KyberPrizrak (www.kyberprizrak.ru)
 * @version 1.0.2 - 2018.07.03 21:10:00 GMT+3
 */

(function(){var d,m,n,p,G,P,Q,H,I,y,u;function R(a,b){try{if(a){if("string"===typeof a&&"#"==a.charAt(0))a=document.getElementById(a.substr(1));else if("string"===typeof a&&"."==a.charAt(0)){try{var c=document.getElementsByClassName(a.substr(1))}catch(X){c=document.querySelectorAll(a)}for(var d=0;d<c.length;d++)R(c[d],b);return}"object"===typeof a&&("object"!==typeof b&&(b={}),"string"!==typeof b.title&&(b.title=a.getAttribute("title")));"object"===typeof a&&"A"==a.tagName?a.onclick=function(){W(a.getAttribute("href"),
b,!0);return!1}:W(a,b,!1)}}catch(X){}}function W(a,b,c){try{d="auto";m="";n="auto";p=10;G=20;Q=P=100;I=H=0;y="rgba(0,0,0,0.7)";z=u=0;"object"===typeof b&&(b.type&&(d=b.type),b.title&&(m=b.title),b.titlePosition&&(n=b.titlePosition),0<=b.padding&&(p=b.padding),0<=b.margin&&(G=b.margin),0<=b.minWidth&&(P=b.minWidth),0<=b.minHeight&&(Q=b.minHeight),0<=b.maxWidth&&(H=b.maxWidth),0<=b.maxHeight&&(I=b.maxHeight),"string"===typeof b.overlayColor&&(y=b.overlayColor));v();J=document.body.style.overflow;e=
document.createElement("div");e.id="microlightbox_overlay";e.onclick=Z;try{e.style.backgroundColor=y}catch(Y){}document.body.style.overflow="hidden";document.body.appendChild(e);e.style.display="block";if("string"===typeof a&&"#"==a.charAt(0)&&(a=document.getElementById(a.substr(1)),!a))return;"auto"==d&&("object"===typeof a?d="IMG"==a.tagName?"image":"inline":"string"===typeof a&&(d=c?"image":"html"));"auto"==n&&(n="image"==d?"inside":"titlebar");"inline"==d&&("object"===typeof a?(k=a,h=document.createElement("div"),
h.id="microlightbox_spoof",h.style.display="none",k.parentNode.insertBefore(h,k),K(a)):d="html");"html"==d&&K(a);"image"==d&&(q=new Image,q.onload=function(){u=q.width;z=q.height;q.id="microlightbox_image";K(q)},q.src="object"===typeof a?a.getAttribute("src"):a)}catch(Y){alert("microlightbox error #2")}}function K(a){t=document.createElement("div");t.id="microlightbox_content";t.style.padding=p+"px";"object"===typeof a?(t.appendChild(a),L=a.style.display,a.style.display=""):t.innerHTML=a;g=document.createElement("div");
g.id="microlightbox_body";g.appendChild(t);"image"==d&&(g.style.overflow="hidden");c=document.createElement("div");c.id="microlightbox_window";f=document.createElement("div");f.id="microlightbox_close";f.innerHTML="&times;";f.onclick=v;m?(r=document.createElement("div"),r.id="microlightbox_title",r.innerHTML=m,"titlebar"==n?(l=document.createElement("div"),l.id="microlightbox_titlebar",l.appendChild(f),l.appendChild(r),c.appendChild(l)):(r.style.marginBottom=p+"px",g.appendChild(r),e.appendChild(f))):
e.appendChild(f);c.appendChild(g);e.appendChild(c);e.style.backgroundImage="none";C()}function C(){try{if(c){var a=l?l.offsetHeight:0,b=0<D&&r&&!l?r.offsetHeight+p:0,e=document.documentElement.clientWidth,h=document.documentElement.clientHeight,k=c.offsetWidth-c.clientWidth,n=c.offsetHeight-c.clientHeight,m=P,M=Q,y=Math.max(m,0<H?H:e-2*G),v=Math.max(M,0<I?I:h-2*G),A=Math.max(1,m-k),w=Math.max(1,M-n-a-b),x=Math.max(A,y-k),E=Math.max(w,v-n-a-b),N=m,O=M;if("image"==d)A=x-2*p,E-=2*p,x=w=0,u>A||z>E?A/
u>E/z?(x=E,w=Math.ceil(E/z*u)):(w=A,x=Math.ceil(A/u*z)):(w=u,x=z),q.width=w,q.height=x,N=w+2*p,O=x+2*p;else{var J=t.scrollHeight,K=g.offsetWidth-g.clientWidth,L=g.offsetHeight-g.clientHeight;N=Math.max(A,t.scrollWidth);O=Math.max(w,J);0==D?v=Math.max(100,M):(N>x&&(O+=L),O>E&&(N+=K))}var B=Math.max(m,Math.min(y,N+k)),F=Math.max(M,Math.min(v,O+n+a+b)),U=Math.round(e/2-B/2),S=Math.round(h/2-F/2);c.style.margin="0px";c.style.left=U+"px";c.style.top=S+"px";c.style.width=B+"px";c.style.height=F+"px";g.style.height=
F-a+"px";if(f&&!l){var R=Math.round(f.offsetWidth/2),V=Math.round(f.offsetHeight/2);S<V||"image"!=d&&0<g.offsetWidth-g.clientWidth?(f.style.left=U+B+"px",f.style.top=Math.max(S-2*V,0)+"px"):(f.style.left=U+B-R+"px",f.style.top=S-V+"px")}("image"!=d||r&&!l)&&B>=D&&F>=T&&(B!=D||F!=T)&&setTimeout(C,10);D=B;T=F}}catch(aa){alert("microlightbox error #3")}}function Z(a){if((a?a.target:window.event.srcElement)==e)return v(),!1}function v(){try{e&&(e.parentNode.removeChild(e),document.body.style.overflow=
J),h&&(k&&(k.style.display=L,h.parentNode.insertBefore(k,h)),h.parentNode.removeChild(h)),T=D=0,J="",L="none",f=r=l=t=g=c=e=q=k=h=null}catch(a){alert("microlightbox error #5")}return!1}var z=u=y=I=H=Q=P=G=p=n=m=d=void 0;var D=0,T=0,J="",L="none",h=null,k=null,q=null,e=null,c=null,g=null,t=null,l=null,r=null,f=null;window.addEventListener?(window.addEventListener("orientationchange",C),window.addEventListener("resize",C)):(window.attachEvent("onorientationchange",C),window.attachEvent("onresize",C));
window.microlightbox=R;window.microlightbox_close=v})();
